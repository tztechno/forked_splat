
---


## **Add Current Camera Position Retrieval Functionality to Viewer - 2025/10/09**

Let's add a function to this viewer to **retrieve the current camera position information**.

While the **V key** already implements a feature to save the data to a hash, we're adding a feature to display it in a more user-friendly way.

The code below will display the current camera position information on the screen and allow it to be copied:

Adding this feature enables the following keyboard shortcuts:



## **Usage**

1.  **C Key** - Retrieve Current Camera Position Information
    * The **View Matrix** is copied to the clipboard.
    * Information is displayed in the **top-left corner of the screen**.
    * **Detailed information** is also output to the **console**.
    * A **complete URL** is generated.
2.  **V Key** (Existing Function)
    * Saves the **View Matrix** to the URL hash.
3.  **R Key** - Hide Camera Information Display
4.  **P Key** (Existing Function)
    * Returns to **Carousel Mode**.



## **Key Features**

* **Automatic Copying**: Camera position information is automatically copied to the clipboard.
* **Visual Feedback**: Information is displayed clearly on the screen.
* **Complete URL Generation**: A ready-to-use URL is generated.
* **Console Output**: Developers can check detailed information in the developer tools.


After manually finding the perfect angle, just press the **C key** to retrieve and copy that position information!

---

The provided View Matrix array describes the camera's orientation and position in 3D space, typically using **column-major order**, where the vectors are stored column by column.

Here is the explanation of the 16 numbers in order:

## View Matrix: 16-Number Explanation (Column-Major)

The 4x4 View Matrix is usually represented as a 1D array of 16 numbers in computer graphics, often following the column-major convention (common in OpenGL and some related systems).

### **Rotation Part (Indices 0-11)**

This section represents a **3x3 rotation matrix**, which defines the camera's orientation (what direction is "right," "up," and "forward" from the camera's perspective).

| Index | Value | Component | Description |
| :---: | :---: | :--- | :--- |
| **0** | $0.95$ | **Column 0 (Right Vector)** - X | X-component of the camera's **Right** direction vector. |
| **1** | $0.16$ | **Column 0 (Right Vector)** - Y | Y-component of the camera's **Right** direction vector. |
| **2** | $-0.26$ | **Column 0 (Right Vector)** - Z | Z-component of the camera's **Right** direction vector. |
| **3** | $0$ | **Column 0 (Fixed)** - W | (Usually 0) Homogeneous coordinate. |
| --- | --- | --- | --- |
| **4** | $-0.16$ | **Column 1 (Up Vector)** - X | X-component of the camera's **Up** direction vector. |
| **5** | $0.99$ | **Column 1 (Up Vector)** - Y | Y-component of the camera's **Up** direction vector. |
| **6** | $0.01$ | **Column 1 (Up Vector)** - Z | Z-component of the camera's **Up** direction vector. |
| **7** | $0$ | **Column 1 (Fixed)** - W | (Usually 0) Homogeneous coordinate. |
| --- | --- | --- | --- |
| **8** | $0.26$ | **Column 2 (Forward/Look Vector)** - X | X-component of the camera's **Forward** (or Look) direction vector. |
| **9** | $0.03$ | **Column 2 (Forward/Look Vector)** - Y | Y-component of the camera's **Forward** (or Look) direction vector. |
| **10** | $0.97$ | **Column 2 (Forward/Look Vector)** - Z | Z-component of the camera's **Forward** (or Look) direction vector. |
| **11** | $0$ | **Column 2 (Fixed)** - W | (Usually 0) Homogeneous coordinate. |

---

### **Position Part (Indices 12-14)**

This section defines the **camera's position** in world space.

| Index | Value | Component | Description |
| :---: | :---: | :--- | :--- |
| **12** | $0.01$ | **Column 3 (Translation)** - X | **X-coordinate** of the Camera Position (Left/Right). |
| **13** | $-1.96$ | **Column 3 (Translation)** - Y | **Y-coordinate** of the Camera Position (Up/Down). |
| **14** | $2.82$ | **Column 3 (Translation)** - Z | **Z-coordinate** of the Camera Position (Depth/Distance). |
| **15** | $1$ | **Column 3 (Fixed)** - W | (Usually 1) Homogeneous coordinate (Scaling). |

---

## Practical Interpretation

For the specific matrix: $[0.95, 0.16, -0.26, 0, -0.16, 0.99, 0.01, 0, 0.26, 0.03, 0.97, 0, 0.01, -1.96, 2.82, 1]$

* **Camera Position**: $(0.01, -1.96, 2.82)$ — The camera is slightly right of the origin, significantly below the origin (on the Y-axis), and forward (positive Z-axis).
* **Forward Direction (Look At)**: $(0.26, 0.03, 0.97)$ — The camera is looking mostly along the positive **Z-axis** (depth), with a slight offset to the right (positive X) and almost no tilt up/down (small positive Y).
* **Up Direction**: $(-0.16, 0.99, 0.01)$ — The camera's "up" is primarily aligned with the positive **Y-axis**, which is standard.

This matrix completely describes **where the camera is located** and **which direction it is facing** in 3D space!

If you'd like to understand the memory layout differences, this video explains **Row-Major vs Column-Major order**: [Row Major order & Column Major order | Data Structures| Lec-07 | Bhanu Priya](https://www.youtube.com/watch?v=NlWEdScxU9k).
http://googleusercontent.com/youtube_content/0

---
---

## **viewerに現在のカメラ位置情報を取得する機能を追加 2025/10/09**

このviewerに現在のカメラ位置情報を取得する機能を追加しましょう。
KeyVキーが既にハッシュに保存する機能として実装されていますが、より分かりやすく表示する機能を追加します。
以下のコードでは、現在のカメラ位置情報を画面上に表示し、コピーできるようにします:
この機能を追加すると、以下のキーボードショートカットが使えるようになります:

使い方
1. Cキー - 現在のカメラ位置情報を取得
    * View Matrixがクリップボードにコピーされます
    * 画面左上に情報が表示されます
    * コンソールにも詳細情報が出力されます
    * 完全なURLも生成されます
2. Vキー (既存機能)
    * View MatrixをURLのハッシュに保存
3. Rキー - カメラ情報表示を非表示
4. Pキー (既存機能)
    * カルーセルモードに戻る
主な機能
* 自動コピー: カメラ位置情報がクリップボードに自動的にコピーされます
* 視覚的フィードバック: 画面に見やすく情報が表示されます
* 完全なURL生成: すぐに使えるURLが生成されます
* コンソール出力: 開発者ツールで詳細を確認できます

手動で最適なアングルを見つけた後、Cキーを押すだけで、その位置情報を取得・コピーできます!

---

View Matrix(ビューマトリックス)の16個の数字の意味を順番に説明します:

```javascript
[
  // 列0: 右方向ベクトル (Camera's Right)
  0.95,  // [0]  X軸の右方向成分
  0.16,  // [1]  Y軸の右方向成分
  -0.26, // [2]  Z軸の右方向成分
  0,     // [3]  (通常0)

  // 列1: 上方向ベクトル (Camera's Up)
  -0.16, // [4]  X軸の上方向成分
  0.99,  // [5]  Y軸の上方向成分
  0.01,  // [6]  Z軸の上方向成分
  0,     // [7]  (通常0)

  // 列2: 前方向ベクトル (Camera's Forward)
  0.26,  // [8]  X軸の前方向成分
  0.03,  // [9]  Y軸の前方向成分
  0.97,  // [10] Z軸の前方向成分
  0,     // [11] (通常0)

  // 列3: カメラ位置 (Camera Position/Translation)
  0.01,  // [12] X座標位置
  -1.96, // [13] Y座標位置
  2.82,  // [14] Z座標位置
  1      // [15] (通常1)
]
```

## 詳細説明

### **回転部分 (インデックス 0-11)**

これは3x3の回転マトリックスで、カメラの向きを表します:

- **列0 [0-2]**: カメラから見た「右」方向
- **列1 [4-6]**: カメラから見た「上」方向  
- **列2 [8-10]**: カメラから見た「前」(視線)方向

この3つのベクトルは互いに直交(垂直)しており、カメラの3D空間での回転を表現しています。

### **位置部分 (インデックス 12-14)**

- **[12]**: X座標 (左右の位置)
- **[13]**: Y座標 (上下の位置)
- **[14]**: Z座標 (奥行きの位置)

### **固定値 (インデックス 3, 7, 11, 15)**

これらは4x4同次座標系のための値で、通常は変更しません。

## 実用的な理解

例えば `[0.95, 0.16, -0.26, 0, -0.16, 0.99, 0.01, 0, 0.26, 0.03, 0.97, 0, 0.01, -1.96, 2.82, 1]` の場合:

- **カメラ位置**: (0.01, -1.96, 2.82) - ほぼ中央、少し下、やや手前
- **視線方向**: (0.26, 0.03, 0.97) - ほぼZ軸正方向を向いている
- **上方向**: (-0.16, 0.99, 0.01) - ほぼY軸正方向が上

このマトリックスは、カメラがどこにいて、どの方向を向いているかを完全に記述しています!

---
